<!DOCTYPE html>
<html>
<head>
  <title>Flower Timer</title>
  <style>
    body { text-align: center; font-family: Arial; margin-top: 50px; }
    #timer { font-size: 48px; margin-bottom: 20px; }
    button { font-size: 20px; padding: 10px 20px; }
    #timerTitle { font-size: 24px; margin-bottom: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <!-- New title text above the timer -->
  <div id="timerTitle">Востаннє квіти поливали</div>

  <div id="timer">0</div>
  <button onclick="startTimer()">Квіти политі</button>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    // Firebase config (ensure this is correct)
    const firebaseConfig = {
      apiKey: "AIzaSyAIRhC9A6SxxjWv7l1niQVrzi8hxXQJYh8",
      authDomain: "sampleprojectvz.firebaseapp.com",
      databaseURL: "https://sampleprojectvz-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "sampleprojectvz",
      storageBucket: "sampleprojectvz.appspot.com",
      messagingSenderId: "652091540259",
      appId: "1:652091540259:web:4f14fed2947c9f89ff4296"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const startTimeRef = db.ref("startTime");

    let timerInterval;

    // Start the timer when button is clicked
    function startTimer() {
      const now = Date.now();
      startTimeRef.set(now);  // Sends the current time to Firebase
    }

    // Function to format time in DD days HH hours MM minutes SS seconds
    function formatTime(milliseconds) {
      const seconds = Math.floor(milliseconds / 1000);
      const days = Math.floor(seconds / (24 * 3600));
      const hours = Math.floor((seconds % (24 * 3600)) / 3600);
      const minutes = Math.floor((seconds % 3600) / 60);
      const remainingSeconds = seconds % 60;

      // Format as "DD days HH hours MM minutes SS seconds"
      return `${days} днів ${pad(hours)} годин ${pad(minutes)} хвилин ${pad(remainingSeconds)} секунд тому`;
    }

    // Helper function to pad single digits with leading zeros
    function pad(num) {
      return num < 10 ? '0' + num : num;
    }

    // Display the formatted timer
    function showTimer(startTime) {
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        const elapsed = Date.now() - startTime;
        document.getElementById("timer").textContent = formatTime(elapsed);
      }, 1000);
    }

    // Listen for changes in the start time from Firebase
    startTimeRef.on("value", (snapshot) => {
      const startTime = snapshot.val();
      if (startTime) {
        showTimer(startTime);  // Call showTimer to update the UI when startTime is received
      }
    });
  </script>
</body>
</html>
